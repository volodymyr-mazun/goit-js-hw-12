{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\nimport axios from 'axios';\n\n// ========== ШЛЯХ ДО РЕСУРСУ ==========\nconst API_KEY = '50367186-ce245e32e2c7fc274bc460135';\nconst BASE_URL = 'https://pixabay.com/api/';\n\n// ========== ФУНКЦІЯ З ПАРАМЕТРАМИ ЗАПИТУ ==========\nexport async function getImagesByQuery(query, page = 1) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,                     //параметр для визначення кількості зображень\n    page: page,\n  };\n\n// ========== ЗАПИТ ЗА ДОПОМОГОЮ МЕТОДУ AXIOS ==========\n  const response = await axios.get(BASE_URL, { params });\n  return {\n    images: response.data.hits,\n    totalHits: response.data.totalHits,\n  };\n}","\n// ========== IMPORT БІБЛІОТЕКИ ==========\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// ========== DOM-ELEMENTS ==========\nconst galleryContainer = document.querySelector('.gallery');     //контейнер для списку\nconst loadMoreBtn = document.querySelector('.load-more');        //кнопка завантажити ще\nconst loaderEl = document.querySelector('.loader');              //контейнер для стилізації лодера\nconst loadingText = document.querySelector('.text-loading');     //контейнер для тексту завантаження\n\n// ========== МОДАЛЬНЕ ВІКНО ЗА ДОПОМОГОЮ SIMPLELIGHTBOX ==========\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',                                           //атрибут для підпису картинки\n  captionDelay: 250,                                             //затримка по часу\n});\n\n// ========== СТВОРЕННЯ РОЗМІТКИ ==========\nexport function createGallery(images) {\n  const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `\n      <li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\" />\n        </a>\n        <div class=\"img-container\">\n          <div class=\"stats\">\n            <p><strong>Likes:</strong> ${likes}</p>\n            <p><strong>Views:</strong> ${views}</p>\n            <p><strong>Comments:</strong> ${comments}</p>\n            <p><strong>Downloads:</strong> ${downloads}</p>\n          </div>\n        </div>\n      </li>`;\n  }).join('');\n  galleryContainer.insertAdjacentHTML('beforeend', markup);      //метод для додавання в DOM-дерево\n  lightbox.refresh();                                            //метод для роботи з simplelightbox, динамічне оновлення\n}\n\n// ========== ВИДАЛЕННЯ РОЗМІТКИ ==========\nexport function clearGallery() {\n  galleryContainer.innerHTML = '';\n}\n\n// ========== ВІДОБРАЖЕННЯ ЛОДЕРА ТА ТЕКСТУ ==========\nexport function showLoader() {\n  loaderEl.classList.add('is-active');\n  loadingText.style.display = 'block';\n}\n\n// ========== ПРИХОВУВАННЯ ЛОДЕРА ТА ТЕКСТУ ==========\nexport function hideLoader() {\n  loaderEl.classList.remove('is-active');\n  loadingText.style.display = 'none';\n}\n\n// ========== ВІДОБРАЖЕННЯ КНОПКИ \"ЗАВАНТАЖИТИ ЩЕ\" ==========\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.add('is-active');\n}\n\n// ========== ПРИХОВУВАННЯ КНОПКИ \"ЗАВАНТАЖИТИ ЩЕ\" ==========\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.remove('is-active');\n}","\n// ========== IMPORT MODULES ==========\nimport { getImagesByQuery } from './js/pixabay-api.js';\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from './js/render-functions.js';\n\n// ========== IZI TOAST ==========\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// ========== DOM-ELEMENTS ==========\nconst form = document.querySelector('.form');                   //форма\nconst input = form.querySelector('input[name=\"search-text\"]');  //поле для запиту\nconst loadMoreBtn = document.querySelector('.load-more');       //кнопка завантажити ще\n\n// ========== ГЛОБАЛЬНІ ЗМІННІ ==========\nlet currentPage = 1;                                            //номер поточної сторінки\nlet currentQuery = '';                                          //збереження останнього пошукового запиту\nlet totalHits = 0;                                              //загальна кількість знайдених елементів\nlet imagesLoaded = 0;                                           //кількість завантажених елементів\nlet lastCardHeight = 0;                                         //збереження висити останнього елемента\n\n// ========== РОБОТА З ФОРМОЮ ==========\nform.addEventListener('submit', async (e) => {\n  e.preventDefault();\n  currentQuery = input.value.trim();\n\n  currentPage = 1;\n  imagesLoaded = 0;\n  clearGallery();                                               //очищення сторінки\n  showLoadMoreButton();                                         //кнопка \"Load more\"\n\n  await fetchAndRender();\n});\n\n// ========== КНОПКА LOAD MORE ==========\nloadMoreBtn.addEventListener('click', async () => {            //лічильник, для подальшого завантаження\n  currentPage += 1;\n  await fetchAndRender();\n});\n\n// ========== MAIN FUNCTION ==========\nasync function fetchAndRender() {\n\nshowLoader();                                                  //анімація завантаження\n\ntry {\n  const { images, totalHits: total } = await getImagesByQuery(currentQuery, currentPage);\n  totalHits = total;\n\n// ========== ПЕРЕВІРКА НА НАЯВНІСТЬ ==========    \nif (images.length === 0 && currentPage === 1) {\n  iziToast.warning({\n    title: 'No results',\n    message: 'Sorry, no images found.',\n    position: 'topRight',\n    backgroundColor: ' #ef4040',\n    messageColor: ' #fafafb',\n    maxWidth: '432px',\n    timeout: 3000,\n  });\n    hideLoadMoreButton();\n    return;\n}\n\n// ========== ПРОДОВЖЕННЯ ЗАВАНТАЖЕННЯ ==========\ncreateGallery(images);\n  imagesLoaded += images.length;\n\n  // ========== ВИСОТА ОСТАННЬОЇ КАРТКИ ТА ПРОКРУТКА ==========\nconst cards = document.querySelectorAll('.gallery-item');                   //елемент списку\n\nif (cards.length > 0) {\n  lastCardHeight = cards[cards.length - 1].getBoundingClientRect().height;  //останній елемент та його точна висота\n    window.scrollBy({                                                       //прокручування сторінки до низу\n    top: lastCardHeight * 2,                                                //висота прокручування на дві картки\n    behavior: 'smooth'                                                      //мяке прокручування\n  });\n}\n\n// ========== ПЕРЕВІРКА НА ЗАКІНЧЕННЯ КОЛЕКЦІЇ ==========\nif (imagesLoaded >= totalHits) {\n  iziToast.info({\n    message: 'We re sorry, but you ve reached the end of search results.',\n    position: 'topRight',\n    backgroundColor: ' #007bff',\n    messageColor: ' #fafafb',\n    maxWidth: '432px',\n    timeout: 3000,\n  });\n    hideLoadMoreButton();                                                   //сховати копку, якщо закінчились елементи\n  } else {\n    showLoadMoreButton();                                                   //відобразити кнопку у випадку фіктивності перевірки\n}\n\n// ========== ОБРОБКА ПОМИЛКИ ==========\n} catch (error) {\n  iziToast.error({\n    message: 'Error fetching images.',\n    position: 'topRight',\n    backgroundColor: ' #ef4040',\n    messageColor: ' #fafafb',\n    maxWidth: '432px',\n    timeout: 3000,\n  });\n\n  } finally {\n    hideLoader();\n  }\n}\n\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","params","response","axios","galleryContainer","loadMoreBtn","loaderEl","loadingText","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","input","currentPage","currentQuery","totalHits","imagesLoaded","lastCardHeight","e","fetchAndRender","total","iziToast","cards"],"mappings":"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"}